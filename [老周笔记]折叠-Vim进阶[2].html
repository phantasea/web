<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
        <title>折叠-Vim进阶[2] - 老周笔记</title>
                <meta name="description" content="Vim进阶教程二，关于折叠">
                <link rel="icon" href="http://b.soont.com/themes/soon/favicon.ico" type="image/x-icon" />
        <link href="http://cdn.staticfile.org/twitter-bootstrap/3.0.2/css/bootstrap.min.css" rel="stylesheet">
        <link href="http://b-soont-com.u.qiniudn.com/themes/soon/css/style_bsoont.css" rel="stylesheet">
    <!--[if lt IE 9]>
      <script src="http://cdn.staticfile.org/html5shiv/3.7/html5shiv.min.js"></script>
      <script src="http://cdn.staticfile.org/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
        <script src="http://cdn.staticfile.org/jquery/2.0.3/jquery.min.js"></script>
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.0.2/js/bootstrap.min.js"></script>
    </head>

    <body>
        <header role="banner" class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button data-target=".bs-navbar-collapse" data-toggle="collapse" type="button" class="navbar-toggle collapsed">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="http://b.soont.com">老周笔记</a>
            </div>
            <nav role="navigation" class="navbar-collapse bs-navbar-collapse collapse" style="height: 1px;">
            <ul class="nav navbar-nav">
                <li> <a href="http://b.soont.com/about">关于</a> </li>
                <li> <a href="http://b.soont.com/weibo">微博</a> </li>
                <li> <a href="http://b.soont.com/disqus">留言</a> </li>
                <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">链接<b class="caret"></b></a>
                        <ul class="dropdown-menu">
  <li class="dropdown-header" >特别感谢</li>
  <li><a href="http://www.vim.org">VIM</a></li>
  <li><a href="http://pico.dev7studios.com">Pico</a></li>
  <li class="divider"></li>
  <li class="dropdown-header" >网站编辑</li>
  <li><a href="https://stackedit.io">MD编辑器</a></li>
  <li class="divider"></li>
  <li class="dropdown-header" >友情链接</li>
  <li class="disabled"><a href="#">期待加入</a></li>
</ul>

                </li>
            </ul>
            <p class="navbar-text navbar-right">求知若饥 虚心若愚</p>
            </nav>
        </div>
        </header>
                
        <div class="container">
            <div class="row">

    <!--[if lt IE 9]>
                        <![endif]-->
                <div class="col-md-9">
                                            <article>
                        <div class="page-header">
                        <h2>折叠-Vim进阶[2]</h2>
                        <em><span class="glyphicon glyphicon-calendar"></span>2013/03/02</em>   <em><span class="glyphicon glyphicon-user"></span>hq零零e</em>  
                        </div>
                        <ul>
<li>前言</li>
<li>1 折叠有什么用途？</li>
<li>2 折叠的生成

<ul>
<li>2.1 折叠层级</li>
<li>2.2 手工规则（manual）</li>
<li>2.3 缩进规则（indent）</li>
<li>2.4 标记规则（marker）</li>
</ul></li>
<li>3 expr规则</li>
<li>4 实例演示

<ul>
<li>4.1 唐诗</li>
<li>4.2 笔记</li>
<li>4.3 邮件</li>
</ul></li>
<li>5 使用提示</li>
<li>6 小结</li>
<li>附录</li>
</ul>

<h2>前言</h2>

<p>折叠对我来说原本不是什么必不可少的功能。但现在却越来越感觉到这实在是个体贴/方便的功能，我经常要保存一些资料但我不喜欢零散的一堆文本文件所以同样的某些特定类型的资料我将它们放在同一个文件中，通过折叠用我可以在同一个文件中管理管理多个文档而不至于混乱。与Vim的其他功能相比折叠是很容易掌握的（至少manual、indent和marker规则是这样的），如果你还没用上这项功能的话赶快往下看吧……</p>

<p>这一篇我们将要讲的是折叠。什么是折叠呢？复制一段文本到一新建文件中，在Vim中输入<code>:set foldmethod=manual</code>。输入<code>:3,8fo</code>，看第三行到第八行是不是折叠起来了呢？这就是Vim的折叠功能，很容易理解吧。先记住相关的帮助命令：</p>

<pre><code>:help folding
:help foldmethod
:help fold-methods
</code></pre>

<p>在Vim中输入<code>:help folding</code>，可以看到Vim中折叠的相关文档。往下翻页你可以看到这里面的内容非常多，尤其是以z开头的那一部分指令。好消息是要用好折叠并不要求全部掌握这些命令。当然至少要掌握这几个命令：<code>zM</code> <code>zR</code> <code>zo</code> <code>zc</code> <code>zf</code>。折叠的用法的精髓在该页的第一部分<code>fold methods</code>。它决定Vim进行折叠所依据的规则。本文的目的是使用户对创建折叠有一个了解。并学会按自己想法来制定折叠规则。</p>

<h2>1 折叠有什么用途？</h2>

<p>如果你用过字处理软件Word的话那你可能会知道Word有一个大纲视图将“标题一”“标题二”作为大纲显示出来而相应的正文则呈现折叠状态。双击一个标题会展开对应的正文。通过这个视图用户可以对文档的结构有一个全局的了解，更可以有效地组织文本。折叠作用与大纲视图相近，同样让你可以有效的管理文档结构；方便地在文档的不同部分移动；让文档更清爽。此外折叠可以隐藏信息将不需要修改或不想看内容折叠起来。另外结合modeline、filetype或autocmd我们可以在更多的场合使用折叠。</p>

<p>Note：请注意我们可以折叠任意行，所以折叠不等同于显示大纲。另外与Word大纲依靠手工套用样式生成不同，折叠可以用手工生成也可以是用户指定的规则生成。通过指定合适的规则我们使折叠成了一种脑力劳动。</p>

<p>折叠让自己的文档看上去更整洁。同时可以方便地选取感兴趣的内容或屏蔽（如果不能删除的话）不想要的内容。如果你的文档有10行的话你可以不想这做，但如果是成百上千行呢？</p>

<p>使用折叠通常要求用户对文档进行某种方式的格式化，这使用户的文档既使在其他文本编辑器上也有较好的可读性。</p>

<p>当然，没有人规定折叠该怎么用，所以发挥你的创意吧。</p>

<h2>2 折叠的生成</h2>

<p>首先要了解foldmethod设置项，它指定了折叠产生的方式。详细的文档请参考这两个命令：</p>

<pre><code>:help foldmethod
:help fold-methods
</code></pre>

<p>其中的manual、indent、expr、syntax、diff、marker规则分别表示根据手工设置、缩进、表达式、语法、diff、标记的方式生成折叠。在了解Vim如何生成折叠之前我们要先了解一个概念：折叠层级</p>

<h3>2.1 折叠层级</h3>

<p>折叠层级是用数字表示的折叠标志，Vim根据折叠层级来决定是否折叠及怎样折叠某一行或某几行。当我们下折叠命令时（zM）Vim对每一行计算折叠层级，然后将折叠层级大于或等于<code>1</code>（默认情况下）的行折叠起来。如果低折叠层级的几行中有高折叠层级的行时就形成折叠的嵌套。</p>

<p>那这个折叠层级是如何计算出来的呢？折叠层级的计算方式取决于我们设定的<code>foldmethod</code>。下面是不同折叠规则对应的计算方式：</p>

<ul>
<li><p><code>manual</code>
手工规则下，折叠层级由折叠区域的嵌套关系计算。当我们手工指定一个折叠的区域后，Vim对这个区域的开始行和结束行做记号，多个区域的开始行和结束行形成了嵌套关系。如果一个折叠区域不包含在其他区域之中，则其折叠层级为1；当这个区域直接包含于另一个区域时则其为折叠层级为另一个区域的层级加1；依些类推。</p></li>
<li><p><code>indent</code>
行的缩进宽度除以`shiftwidth‘，并向下取整得到每一行的折叠层级。同一折叠层级及更高折叠层级的连续行形成折叠。而其中的更高折叠层级的行——如果有的话，形成嵌套的折叠。</p></li>
<li><p><code>marker</code>
当使用标记规则折叠时，层级的计算跟手工规则相似。除了它是根据文件中的标记来划分一个折叠区域而不是手工指定。然后根据这些区域间的嵌套关系计算折叠层级。具体使用的标记通过<code>foldmarker</code>设置。默认是使用<code>{{{,}}}</code>。</p></li>
<li><p><code>syntax</code>
跟<code>marker</code>差不多，只是所用的标记是在语法文件中定义的，而不是通过<code>foldmarker</code>设置。</p></li>
<li><p><code>diff</code>
除了差异行及其前后三行<sup id="fnref:1"><a href="#fn:1" class="footnote-ref">1</a></sup>外，其余行折叠（层级为1）。</p></li>
<li><p><code>expr</code>
由用户指定折叠层级的计算方式。方法是对<code>foldexpr</code>进行设置。具体用法稍后说明。</p></li>
</ul>

<h3>2.2 手工规则（manual）</h3>

<p>首先设置设置foldmethod为manual或者marker（没错marker也行）。然后高亮选择可折叠的行，输入指令<code>zf</code>。就这么简单你已经折叠了文本。还可以在命令行用:fold用法跟其他Vim指令一样，如<code>:1,.fo</code>表示将第一行到当前行都折叠起来。需要注意的是如果使用marker折叠规则的话新建折叠时Vim会为指定范围的开始和结束行添加标记（marker）。</p>

<p>注意：如果只折叠一行的话，你可能不会立即看到效果。</p>

<h3>2.3 缩进规则（indent）</h3>

<p>首先，设置规则<code>:set foldmethod=indent</code>。然后在编辑过程中依需要进行缩进<sup id="fnref:2"><a href="#fn:2" class="footnote-ref">2</a></sup>。</p>

<p>缩进挺容易理解的，将下面的例子复制到文件中保存关闭再用Vim打开看看：</p>

<pre><code>开始
    第一行         折叠层级为1，无嵌套
    第二行
        第三行     折叠层级为2，第1层嵌套
        第四行
            第五行 折叠层级为3，第2层嵌套
            第六行
        第七行     折叠层级为2，第1层嵌套
    第八行         折叠层级为1，无嵌套
            第九行 折叠层级为3，无嵌套
            第五行
结束
vim: shiftwidth=4:foldmethod=indent
</code></pre>

<p>注意：正如前面提到的折叠的层级并不仅仅取决于你按了几个空格或制表符还与<code>shiftwidth</code>有关。改变上面例子中的<code>shiftwidth</code>看有什么不一样。</p>

<h3>2.4 标记规则（marker）</h3>

<p>见手工规则。</p>

<h2>3 expr规则</h2>

<p>expr要比前面的几种方式复杂点所以我们在这里单独讨论。使用expr时，我们需要对一设置项进行设置——<code>foldexpr</code>。它是用来保存我们设定的表达式，也就是我们指定的计算折叠层级的公式。我们将设置项设为特定的表达式，然后Vim通过<code>foldexpr</code>这个项得到我们所指定的表达式，Vim逐行处理，并对每一行使用这个表达式计算出一个数值。这个数值就是该行的折叠层级，根据层级进行折叠。举个例子：假设我们在Vim中使用了如下命令：</p>

<pre><code>:set foldmethod=expr
:set foldexpr=1
</code></pre>

<p>所有的行都会被折叠（如果没有的话再输入指令<code>zM</code>）。Vim在每一行用foldexpr指定的表达式计算结果。这个例子中我们的表达式是1，所以每行得到的折叠层级都是1，于是所有行折叠成一行。同理如果你将它赋于2的话则所有行的折叠层级为2，所有行被折叠成一行。当我们的表达式最后返回一个数值时这个数值就是折叠层级。为了让这表达式更灵活，更能满足我们的需要我们需要补足一些Vim脚本知识<sup id="fnref:3"><a href="#fn:3" class="footnote-ref">3</a></sup>，这里是三个在折叠的表达式比较常用几点：</p>

<ul>
<li><p><code>v:lnum</code>
内置变量，表示是“当前行的行号”。:help v:var查看更多内置变量。</p></li>
<li><p><code>getline()</code>
函数用以返回指定行的内容。</p></li>
<li><p><code>?:</code>
三元条件语句。见:help expr1</p></li>
</ul>

<p>另外如果需要构造复杂的表达式，我们可以在自定义的函数中定义。但这又是另一篇教程了。</p>

<p>看一下现在我们能构造出怎么样的表达式：</p>

<pre><code>:set foldexpr=v:lnum
</code></pre>

<p>指定每行的行号为折叠层级，这样所有行会折叠成一行。试试看用指令<code>zo</code>逐层打开折叠，打开20层之后就没有折叠了——而不是我们想的“嵌套数＝行数”。这是因为Vim对折叠的嵌套数是有限制的，默认最深可以20层。但我们可以用foldnestmax这个项来进行自定义设置，如<code>set foldnestmax=10</code>。</p>

<p>注意：Vim最多支持20层的嵌套，所以设置超过20的值会被当成20。</p>

<p>将第8至第20行折叠。也就是让expr在第8至20行时返回数值1（也可以是2、3、4……），其他时候为0。我们知道Vim是逐行处理的，所以如果我们知道Vim正在处理的行的行号我们就可以进行比较了。当然你已经知道了，我们需要的就是`v:lnum‘：</p>

<pre><code>v:lnum&gt;=8&amp;&amp;v:lnum&lt;=20?1:0
v:lnum&gt;=8\ &amp;&amp;\ v:lnum&lt;=20\ ?\ 1:0
</code></pre>

<p>下面是用expr规则模拟indent规则的例子。基本上没有任何实用价值，但至少能让我们又expr的强大有个认识：</p>

<pre><code>" source this.vim
set foldmethod=expr
set foldexpr=Myindent(v:lnum)
" 用expr模拟indent规则
func! Myindent(lnum)
" 用indent()函数得到当前缩进
let s:idt=indent(a:lnum)
" 用&amp;操作符得到一个设置项shiftwidth的值
let s:sw=&amp;shiftwidth
" 如果有缩进宽度超过阈值(shiftwidth)
if s:idt&gt;=s:sw
   " 则计算折叠层级
   return (s:idt-s:idt%s:sw)/s:sw
else
   return 0
endf
</code></pre>

<p>除了可以向foldexpr返回数值外还可以返回一些特殊的值，分别是=, a, s, &lt;, >（详细说明见<code>:help fold-expr</code>，这里不现重复）。Vim的文档不推荐使用=, a, s。
这里再给两个简单的例子：</p>

<pre><code>" 如果一行以@samp{#}开始，折叠。
:set foldexpr=getline(v:lnum)=~/^#/?1:0
" 以每5行为一组折叠
set v:lnum%5-1?1:'&gt;1'
</code></pre>

<h2>4 实例演示</h2>

<p>折叠在写程序时是比较常用的比如python、C语言之类可以将规则设置为`indent‘进行折叠。但我说过了折叠可以有很多不同的用法。下面简单的举几个例子演示一下折叠还能怎么用。由于这里面有些内容需要用到Vim脚本的知识，我不会在这里详细解说，有不明白的地方可以发邮件给我。</p>

<h3>4.1 唐诗</h3>

<p>这里我借唐诗的例子演示一下expr规则和<code>foldtext</code>设置项的用法。下面是一个文件的内容，这是一个有80首诗的文件每首诗之间有一空行。我的阅读的习惯是看一下目录然后挑自己感兴趣的部分。所以我决定用折叠来模拟目录的效果。</p>

<blockquote>
  <p>《感遇其一》<br />
  作者：张九龄
  兰叶春葳蕤，桂华秋皎洁。<br />
  欣欣此生意，自尔为佳节。<br />
  谁知林栖者，闻风坐相悦。<br />
  草木有本心，何求美人折？<br />
  <br />
  《感遇其二》<br />
  作者：张九龄<br />
  江南有丹桔，经冬犹绿林。<br />
  岂伊地气暖，自有岁寒心。<br />
  可以荐佳客，奈何阻重深。<br />
  运命唯所遇，循环不可寻。<br />
  徒言树桃李，此木岂无阴。<br />
  <br />
  《下终南山过斛斯山人宿置酒》<br />
  作者：李白<br />
  暮从碧山下，山月随人归。<br />
  却顾所来径，苍苍横翠微。<br />
  相携及田家，童稚开荆扉。<br />
  绿竹入幽径，青萝拂行衣。<br />
  欢言得所憩，美酒聊共挥。<br />
  长歌吟松风，曲尽河星稀。<br />
  我醉君复乐，陶然共忘机。</p>
</blockquote>

<p>首先，确定使用的折叠规则。大概的看一下前面的几种规则，看来我们只能用<code>expr</code>规则了。因为我们要将空行以外的所有部分折叠起来。所以我们可以构造这样的表达式：</p>

<pre><code>" 用getline(v:lnum)得到当前行
" 用正则表达式@samp{.}判断当前行是否含有文字。
set foldexpr=getline(v:lnum)=~'.'?1:0
</code></pre>

<p>将上面的唐诗复制到一文件中，用Vim打开，设置折叠。是不是看到所有的诗折叠了。不过还有一个问题，在折叠文本（<code>foldtext</code>）中没有注明诗的作者这样的话这个目录似乎有点美中不足。不过我们可以定义折叠文本（<code>:help 'foldtext'</code>）的：</p>

<pre><code>`" 想显示诗人？
`set foldtext=foldtext().v:folddashes.getline(v:foldstart+1)
</code></pre>

<p>通过设置<code>foldcolumn</code>，我们还可以使用鼠标来打开或折叠一首诗。最后我们可以在该文件的最后加入一模式行这样我们每次打开都有折叠的效果了：</p>

<pre><code>vim: ro: fdm=expr: fde=getline(v\:lnum)=~'.'?1\:0: foldtext=foldtext().v\:folddashes.getline(v\:foldstart+1): foldcolumn=2
</code></pre>

<p>上面的折叠表达式中不同的折叠（诗）之间有一空行，如果希望显示效果更紧凑一点的话试一下这个表达式：</p>

<pre><code>set foldexpr=getline(v:lnum)=~'\\S'&amp;&amp;getline(v:lnum-1)!~'\\S'?'&gt;1':'='
</code></pre>

<h3>4.2 笔记</h3>

<p>在阅读文本文件或者多人共同创作说明文档时，经常需要作一些笔记。这些笔记可以是读书心得、体会，也可以是创作说明或者作为以后扩充内容的占位符。如果有很多的笔记的话会影响原文档的可读性，通过折叠笔记我们可以在保留这些笔记的前提下，保证文档的可读性。</p>

<ol>
<li>使用模式行vim: se fdm=marker</li>
<li>选择合适的地方写下自已的想法或注释。</li>
<li>使用<code>zf</code>或<code>:fo</code>进行折叠。</li>
</ol>

<p>这样自己做笔记的地方总是高亮显示。
同时可以使用</p>

<pre><code>:folddoclosed .w! &gt;&gt;笔记.txt
</code></pre>

<p>来导出笔记。</p>

<p>注意：<code>:folddoclosed</code><sup id="fnref:4"><a href="#fn:4" class="footnote-ref">4</a></sup>只对当前关闭的折叠有效，所以如果要导出所有折叠可以先使用指令<code>zR</code>。如果要删除所有的marker，<code>:g/{{{/norm zD</code></p>

<p>4.3 邮件</p>

<p>我习惯在本地保存一份邮件的副本但有时候在翻以前的邮件时很不方便。因为邮件头通常很长尤其是邮件列表（maillist）中的邮件，有时要看正文得先按好几次CTRL-F。当然在学了折叠后我们当然有更好的办法。</p>

<p>我们以下面这封精简过邮件头并作了适当的修改（防垃圾邮件:(）的邮件为例：</p>

<pre><code><br />Received: from sino.cmm (unknown [202.108.xx.230])
Received: (qmail 25748 invoked by uid 99); 30 Dec 2004 04:42:47 -0000
Message-ID: &lt;200412300xxx47.25xxx.qmail@sino.cmm&gt;
From: chxxxx &lt;chxxxx@sino.cmm&gt;
To: hqxxe@123.cmm
Subject: RE: XX报告
MIME-Version: 1.0
Date: Thu, 30 Dec 2004 12:42:47 +0800
X-Priority: 3

hqxxe：

    你的报告已经收到,谢谢!

                                      陈

----- Original Message -----
&gt; ………………
&gt; blah blah
&gt;&gt; blah blah
&gt;&gt; blah blah

</code></pre>

<p>在'.vimrc'（windows中是'_vimrc'）中加入，下面的内容：</p>

<pre><code>" 根据邮件的后缀名进行相关的设置。如果打开的文件后缀名是'.eml'，则当成邮件处理。
autocmd! BufReadPre *.eml se fdm=expr fde=v:lnum==1?1:getline(v:lnum)=~'^$'?0:'=' fdt=Mailfdt(v:foldstart,v:foldend) ft=mail | syn on

" 定义函数，用来返回折叠的标题。
" 以折叠的第一和最后一行的行号为参数
func! Mailfdt(fst,fen)
 let fst=a:fst
 " 保存邮件的标题和发信人
 let hfrom=''
 let hsub=''
 let tline=''
 while a:fen!=fst
    let tline=getline(fst)
    " 判断当前行是否是我们感兴趣的行
    " 如果是则保存
    if tline=~'^From: '
       let hfrom=tline
    elseif tline=~'^Subject: '
       let hsub=tline
    endif
    let fst=fst+1
 endwhile
" 返回相关信息
if strlen(hfrom) || strlen(hsub)
    return hsub . "\t\t\t" . hfrom
else
    return getline(a:fst)
endif
endfunc
</code></pre>

<p>在加入上面的内容后，我们现在用Vim打开邮件（实际是以.eml作后缀名的文件）看看，是不是清爽多了！</p>

<h2>5 使用提示</h2>

<p>使用manual一般是临时性的折叠。如果每次编辑特定文件都需要做同样折叠时时建议结合modeline使用其他折叠规则。如果不得不使用manual方式时，你可以用<code>:mksession</code>保存包括折叠在内的一切当前编辑设置或者用<code>:mkview</code>保存当前窗口。具体说明见文档。</p>

<p>indent和marker的折叠规则可以用于程序文件或格式文本。一般可以配合modeline使用。</p>

<p>syntax通常用于程序或特定格式的文本。并且由于是在语法文件中定义的所以一般与autocommand一起使用。<code>:help filetype</code> <code>:help command</code></p>

<p>diff用于比较文件内容后对照修改时使用。可用<code>:mkview</code>或<code>:mksession</code>保存设置。</p>

<p>expr在上面几种方式无法满足需要时我们要使用expr方式。expr可以在模式行中保存设置，也可以保存在Vim的脚本中。相关命令<code>:mkvimrc</code> <code>:mksession</code></p>

<h2>6 小结</h2>

<p>这一篇中我们简单的介绍了Vim中进行折叠的原理，及几种相关的折叠规则及其使用方法。expr规则实际是一种自定义规则，在学习了Vim脚本后我们还能构造出更复杂的规则。但就现在而言用户掌握了manual、indent和marker就行了（虽然在前面我们举了许多expr的例子，但在实际运用中expr用得比较少，因为通常用户不会绞尽脑汁只为了将文本折叠起来——包括我自己。当然你想要成为进阶用户这是一定要掌握的！）syntax和diff方式会另外讲解，敬请期待。</p>

<p>下一篇我们将开始讨论与编辑相关的一些内容。下次见。</p>

<h2>附录</h2>

<p>这是比较不常用但又可能比较有用的内容。使用:help查看相关信息。</p>

<pre><code>v:foldstart 内置变量    只读变量记录只前所在折叠的起始行号
v:foldend   内置变量    结束行号，其余同上
foldlevel() 函数  返回指定行的折叠层级
foldlevel   设置项 只有高于这个值的折叠层级才会进行折叠
foldnestmax 设置项 指定最深的嵌套数
foldignore  设置项 在indent规则中以这个值开始的行的将根据前后行的值来设定折叠层级
:folddoclose    命令  对当前闭合的行运行命令
:folddoopen 命令  对未折叠的行或定义了折叠但未闭合的行运行命令
</code></pre>

<div class="footnotes">
<hr />
<ol>

<li id="fn:1">
<p>具体行数可通过`diffopt‘选项变更&#160;<a href="#fnref:1" rev="footnote" class="footnote-backref">&#8617;</a></p>
</li>

<li id="fn:2">
<p>可以试试自动缩进的功能`:se ai‘——如果你还没用上的话&#160;<a href="#fnref:2" rev="footnote" class="footnote-backref">&#8617;</a></p>
</li>

<li id="fn:3">
<p>更多内容参考`:help vim-script‘&#160;<a href="#fnref:3" rev="footnote" class="footnote-backref">&#8617;</a></p>
</li>

<li id="fn:4">
<p>:help :folddoopen :help :folddoclosed&#160;<a href="#fnref:4" rev="footnote" class="footnote-backref">&#8617;</a></p>
</li>

</ol>
</div>

                        </article>
                        <hr class="soften">
                                                <ul class="pager">
                            <li class="previous"><a href="http://b.soont.com/vim/tut_modeline" title="模式行-Vim进阶[1]">上一篇</a></li>
                            <li class="next"><a href="http://b.soont.com/vim/tut_script" title="脚本-Vim进阶[3]">下一篇</a></li>
                        </ul>
                                                        
                        </div>

                        <div class="col-md-3">
                            <!--
                            <div id="googlesearch">
                                <script>
                                  (function() {
                                    var cx = '015053503464820548847:d8u_zcpmbhq';
                                    var gcse = document.createElement('script');
                                    gcse.type = 'text/javascript';
                                    gcse.async = true;
                                    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
                                        '//www.google.com/cse/cse.js?cx=' + cx;
                                    var s = document.getElementsByTagName('script')[0];
                                    s.parentNode.insertBefore(gcse, s);
                                  })();
                                </script>
                                <gcse:search></gcse:search>
                                </div>
                                -->
                            <div class="nav-group">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <ul class="nav nav-pills nav-stacked" id="navv">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <li><a data-toggle="collapse" data-parent="#navv" href="#category1" class="collapsed"><span id="folder1" class="glyphicon glyphicon-folder-close"></span> LINUX<span class="badge pull-right">8</span></a></li>
                                    <li>
                                    <ul id="category1"  class="nav nav-pills nav-stacked collapse">
                                                                                                                                                                                                        <li><a href="http://b.soont.com/linux/linux-tar"><small>Linux下归档与压缩<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                <li><a href="http://b.soont.com/linux/tmux"><small>tmux终端复用<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <li><a href="http://b.soont.com/linux/vim-tabnew"><small>Ubuntu下Gvim自动在新标签页打开文件<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                <li><a href="http://b.soont.com/linux/date"><small>date日期命令<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                <li><a href="http://b.soont.com/linux/shell-shortcuts"><small>Shell快捷键<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <li><a href="http://b.soont.com/linux/shell-tips"><small>Shell小技巧<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <li><a href="http://b.soont.com/linux/git"><small>GIT笔记<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <li><a href="http://b.soont.com/linux/rsync"><small>rsync同步命令<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </ul>
                                    </li>
                        <script type="text/javascript">
                            $('#category1').on('show.bs.collapse', function () {
                                $("#folder1").attr("class","glyphicon glyphicon-folder-open");});
                            $('#category1').on('hidden.bs.collapse', function () {
                                $("#folder1").attr("class","glyphicon glyphicon-folder-close");
});</script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <li><a data-toggle="collapse" data-parent="#navv" href="#category2" class="collapsed"><span id="folder2" class="glyphicon glyphicon-folder-open"></span> VIM<span class="badge pull-right">15</span></a></li>
                                    <li>
                                    <ul id="category2"  class="nav nav-pills nav-stacked collapse in">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <li><a href="http://b.soont.com/vim/vim-tips"><small>VIM小技巧<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <li><a href="http://b.soont.com/vim/zencoding"><small>ZenCoding(emmet)前端利器<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <li><a href="http://b.soont.com/vim/tut_indent"><small>缩进-Vim进阶[8]<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                <li><a href="http://b.soont.com/vim/tut_tags"><small>Tags-Vim进阶[7]<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                <li><a href="http://b.soont.com/vim/tut_bang"><small>外部程序-Vim进阶[6]<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                <li><a href="http://b.soont.com/vim/tut_hl"><small>高亮-Vim进阶[5]<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                <li><a href="http://b.soont.com/vim/tut_register"><small>寄存器-Vim进阶[4]<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                <li><a href="http://b.soont.com/vim/tut_script"><small>脚本-Vim进阶[3]<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                <li class="active"><a href="http://b.soont.com/vim/tut_folding"><small><em>折叠-Vim进阶[2] <span class="glyphicon glyphicon-eye-open"></span></em></small></a></li>
                                                                                                                                                                                                                                                                                                                                <li><a href="http://b.soont.com/vim/tut_modeline"><small>模式行-Vim进阶[1]<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                <li><a href="http://b.soont.com/vim/part4"><small>第四章 替换命令<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                <li><a href="http://b.soont.com/vim/part3"><small>第三章 功能强大的全局命令<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                <li><a href="http://b.soont.com/vim/part2"><small>第二章 行模式地址<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                <li><a href="http://b.soont.com/vim/part1"><small>第一章 Vi基础<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <li><a href="http://b.soont.com/vim/vundle"><small>Vundle插件管理<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </ul>
                                    </li>
                        <script type="text/javascript">
                            $('#category2').on('show.bs.collapse', function () {
                                $("#folder2").attr("class","glyphicon glyphicon-folder-open");});
                            $('#category2').on('hidden.bs.collapse', function () {
                                $("#folder2").attr("class","glyphicon glyphicon-folder-close");
});</script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <li><a data-toggle="collapse" data-parent="#navv" href="#category3" class="collapsed"><span id="folder3" class="glyphicon glyphicon-folder-close"></span> 计算机<span class="badge pull-right">3</span></a></li>
                                    <li>
                                    <ul id="category3"  class="nav nav-pills nav-stacked collapse">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <li><a href="http://b.soont.com/md/php-markdown"><small>PHP Markdown Extra 中文使用说明<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <li><a href="http://b.soont.com/classic/smart-questions-zh"><small>提问的智慧<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <li><a href="http://b.soont.com/md/syntax_cn"><small>Markdown 语法<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </ul>
                                    </li>
                        <script type="text/javascript">
                            $('#category3').on('show.bs.collapse', function () {
                                $("#folder3").attr("class","glyphicon glyphicon-folder-open");});
                            $('#category3').on('hidden.bs.collapse', function () {
                                $("#folder3").attr("class","glyphicon glyphicon-folder-close");
});</script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <li><a data-toggle="collapse" data-parent="#navv" href="#category4" class="collapsed"><span id="folder4" class="glyphicon glyphicon-folder-close"></span> RUBY<span class="badge pull-right">1</span></a></li>
                                    <li>
                                    <ul id="category4"  class="nav nav-pills nav-stacked collapse">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <li><a href="http://b.soont.com/ruby/requre-load-include"><small>requre load include 区别<span class="glyphicon glyphicon-file"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </ul>
                                    </li>
                        <script type="text/javascript">
                            $('#category4').on('show.bs.collapse', function () {
                                $("#folder4").attr("class","glyphicon glyphicon-folder-open");});
                            $('#category4').on('hidden.bs.collapse', function () {
                                $("#folder4").attr("class","glyphicon glyphicon-folder-close");
});</script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <li><a data-parent="#navv" data-toggle="collapse" href="#nocategory" class="collapsed"><span class="glyphicon glyphicon-tags"></span> 未分类<span class="badge pull-right">1</span></a></li>
                                <li>
                                <ul id="nocategory" class="nav nav-pills nav-stacked collapse">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <li><a href="http://b.soont.com/diary/2013.11.04"><small>V <span class="glyphicon glyphicon-tag"></span></small></a></li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </ul>
                                </li>
                            </ul>
                            </div>
                        </div>


                    </div>
                </div><!--container-->

                <footer role="contentinfo" class="bs-footer">
                <hr>
                <div class="container">
                    <p class="text-center"><a href="http://www.vim.org" title="用VIM进行创作"><img alt="用VIM进行创作" src="http://dn-bsoont.qbox.me/themes/soon/vim_powered.png" /></a></p>
                    <p class="text-center"><small>作品采用</small><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh"><img alt="知识共享许可" src="http://dn-bsoont.qbox.me/themes/soon/cc.png" /></a><small>进行许可</small></p>
                    <p class="text-center"> <small>&copy; 2012 - 2013 Designed by <a href="http://www.soont.com">Maucat <span class="glyphicon glyphicon-leaf"></span></a></small></p>
                </div>
                </footer>

        <script src="http://cdn.staticfile.org/jquery-scrollUp/2.1.0/jquery.scrollUp.min.js"></script>
        <script src="http://cdn.staticfile.org/mathjax/2.2/MathJax.js"></script>
        <script src="http://cdn.staticfile.org/mathjax/2.2/config/TeX-AMS_HTML.js"></script>
        <script src="http://dn-bsoont.qbox.me/themes/soon/js/bootstrap-paginator.min.js"></script>
<script>
        // 动态效果完成后更改心心与下拉的箭头，以及点击后给li加上active的class
            $(document).ready(function(){
                $("#desc1").hide();
                $("#xinxin1").attr("class","glyphicon glyphicon-heart pull-right");
                $("#jiantou1").attr("class","glyphicon glyphicon-chevron-up");
                $(".nav-group li").click(function(){
                    $(".nav-group li").removeClass("active");
                    $(this).addClass("active");
                    });
                //为文章内的表格添加table class
                $("article>table").addClass("table");
                //给不是内部链接的链接加上target属性，_blank值
                $("a[href*='http://']:not([href*='"+location.hostname+"']),[href*='https://']:not([href*='"+location.hostname+"'])").attr("target","_blank");
                //锚点偏移

                $("article a, .panel-body a").click(function() {
                        $("html, body").animate({
                            scrollTop: $($(this).attr("href")).offset().top - 70 + "px"
                        }, 0);
                        return false;
                    });
                });


                // 分页插件                     
var options = {
    currentPage: 1,
    totalPages: 6,
    bootstrapMajorVersion: 1,
    pageUrl: function(type, page, current){

        return "http://b.soont.com/page/"+page;

    },
tooltipTitles: function (type, page, current) {
                    switch (type) {
                    case "first":
                        return "第一页";
                    case "prev":
                        return "上一页";
                    case "next":
                        return "下一页";
                    case "last":
                        return "最后一页";
                    case "page":
                        return null;
                    }
                }
    }
    $('#pagin').bootstrapPaginator(options);

//滚动到页顶设置
		$(function () {
			$.scrollUp({
		        scrollName: 'scrollUp', // Element ID
		        scrollDistance: 300, // Distance from top/bottom before showing element (px)
		        scrollFrom: 'top', // 'top' or 'bottom'
		        scrollSpeed: 1300, // Speed back to top (ms)
		        easingType: 'linear', // Scroll to top easing (see http://easings.net/)
		        animation: 'slide', // Fade, slide, none
		        animationInSpeed: 500, // Animation in speed (ms)
		        animationOutSpeed: 500, // Animation out speed (ms)
		        scrollText: '回到页首', // Text for element, can contain HTML
		        scrollTitle: false, // Set a custom <a> title if required. Defaults to scrollText
		        scrollImg: false, // Set true to use image
		        zIndex: 10000 // Z-Index for the overlay
			});
		});
</script>
            </body>
        </html>
