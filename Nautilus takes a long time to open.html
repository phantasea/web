
  site logo *Join Ask Ubuntu*

By clicking “Sign up”, you agree to our terms of service
<https://askubuntu.com/legal/terms-of-service/public> and acknowledge
you have read our privacy policy
<https://askubuntu.com/legal/privacy-policy>.

Sign up with Google


  OR

Email

Password

Sign up

Already have an account? Log in <https://askubuntu.com/users/login>

  * Ubuntu <http://www.ubuntu.com/>
  * Community <http://community.ubuntu.com/>
  * Ask! <http://askubuntu.com/>
  * Developer <http://developer.ubuntu.com/>
  * Design <http://design.ubuntu.com/>
  * Hardware <http://www.ubuntu.com/certification>
  * Insights <http://insights.ubuntu.com/>
  * Juju <https://jujucharms.com/>
  * Shop <http://shop.ubuntu.com/>
  * More › <#>
      o Apps <http://apps.ubuntu.com/>
      o Help <https://help.ubuntu.com/>
      o Forum <http://ubuntuforums.org/>
      o Launchpad <http://www.launchpad.net/>
      o MAAS <http://maas.ubuntu.com/>
      o Canonical <http://www.canonical.com/>

Skip to main content <#content>
<#>

<#>


        Stack Exchange Network

Stack Exchange network consists of 183 Q&A communities including Stack
Overflow <https://stackoverflow.com/>, the largest, most trusted online
community for developers to learn, share their knowledge, and build
their careers.

Visit Stack Exchange <https://stackexchange.com/>

Loading…

 1.

    <https://askubuntu.com/help>
      * Tour Start here for a quick overview of the site
        <https://askubuntu.com/tour>
      * Help Center Detailed answers to any questions you might have
        <https://askubuntu.com/help>
      * Meta Discuss the workings and policies of this site
        <https://meta.askubuntu.com/>
      * About Us Learn more about Stack Overflow the company, and our
        products <https://stackoverflow.co/>
 2.

    <https://stackexchange.com/>
 3.


          current community <https://askubuntu.com/>

      *
        Ask Ubuntu <https://askubuntu.com/>
        help <https://askubuntu.com/help> chat
        <https://chat.stackexchange.com/?tab=site&host=askubuntu.com>
      *
        Ask Ubuntu Meta <https://meta.askubuntu.com/>


          your communities

    Sign up
    <https://askubuntu.com/users/signup?ssrc=site_switcher&returnurl=https%3a%2f%2faskubuntu.com%2fquestions%2f1341909%2ffile-browser-and-file-dialogs-take-a-long-time-to-open-or-fail-to-open-in-all-ap> or log in <https://askubuntu.com/users/login?ssrc=site_switcher&returnurl=https%3a%2f%2faskubuntu.com%2fquestions%2f1341909%2ffile-browser-and-file-dialogs-take-a-long-time-to-open-or-fail-to-open-in-all-ap> to customize your list.


          more stack exchange communities <https://stackexchange.com/sites>

    company blog <https://stackoverflow.blog/>
 4.
 5. Log in
    <https://askubuntu.com/users/login?ssrc=head&returnurl=https%3a%2f%2faskubuntu.com%2fquestions%2f1341909%2ffile-browser-and-file-dialogs-take-a-long-time-to-open-or-fail-to-open-in-all-ap>
 6. Sign up
    <https://askubuntu.com/users/signup?ssrc=head&returnurl=https%3a%2f%2faskubuntu.com%2fquestions%2f1341909%2ffile-browser-and-file-dialogs-take-a-long-time-to-open-or-fail-to-open-in-all-ap>

Ask Ubuntu <https://askubuntu.com/>

 1.
     1.

        Home
        <https://askubuntu.com/>
     2.

        Questions
        <https://askubuntu.com/questions>
     3.

        Tags
        <https://askubuntu.com/tags>
     4.
     5.

        Users
        <https://askubuntu.com/users>
     6.

        Companies
        <https://stackoverflow.com/jobs/companies?so_medium=askubuntu&so_source=SiteNav>
     7.

        Unanswered
        <https://askubuntu.com/unanswered>
 2.
    Teams

    Ask questions, find answers and collaborate at work with Stack
    Overflow for Teams.

    Try Teams for free
    <https://stackoverflowteams.com/teams/create/free/?utm_medium=referral&utm_source=askubuntu-community&utm_campaign=side-bar&utm_content=explore-teams> Explore Teams <https://stackoverflow.co/teams/?utm_medium=referral&utm_source=askubuntu-community&utm_campaign=side-bar&utm_content=explore-teams>
 3.
    Teams
    <javascript:void(0)>
 4.

    Ask questions, find answers and collaborate at work with Stack
    Overflow for Teams. Explore Teams
    <https://stackoverflow.co/teams/?utm_medium=referral&utm_source=askubuntu-community&utm_campaign=side-bar&utm_content=explore-teams-compact>

*Teams*

Q&A for work

Connect and share knowledge within a single location that is structured
and easy to search.

Learn more about Teams <https://stackoverflow.co/teams/>


  File browser and file dialogs take a long time to open or fail to open
  in all applications
  <https://askubuntu.com/questions/1341909/file-browser-and-file-dialogs-take-a-long-time-to-open-or-fail-to-open-in-all-ap>

Ask Question <https://askubuntu.com/questions/ask>
Asked 3 years, 9 months ago
Modified 11 months ago
<https://askubuntu.com/questions/1341909/file-browser-and-file-dialogs-take-a-long-time-to-open-or-fail-to-open-in-all-ap?lastactivity>
Viewed 12k times

This question shows research effort; it is useful and clear
23

Save this question.
<https://askubuntu.com/posts/1341909/timeline>Show activity on this post.

I'm using Ubuntu 20.04, with i3 as the window manager but the gnome
subsystem installed.

I have a problem that at some random interval (hours or days) after a
reboot, any attempt to open thunar or nautilus, or any attempt by an
application (such as Firefox) to open a file dialog either takes a
minute or more to open, or just times out forever and requires me to
kill the application.

How can I find out which application, file, extension or driver is
behind this delay?

I've tried the following:

  * Running as root - the applications are fast as normal.
  * Disable tracker (as per here
    <https://superuser.com/questions/889613/open-file-dialog-box-takes-a-long-time-to-appear-on-all-applications>)
  * libgoa seems up to date (as per this
    <https://lists.debian.org/debian-user/2018/07/msg00043.html>)
  * Tried the pulseaudio hack here
    <https://askubuntu.com/questions/1254787/pop-up-dialogs-very-slow-on-ubuntu-20-04>
  * Running nautilus with strace; there's a 30-second gap with the below
    lines, but I'm not sure how to interpret it (fd=24 is some file
    descriptor?)
  * |journalctl| shows the below when (e.g.) nautilus finally works

I have several machines with very similar setups, only one has this
behaviour. I can't figure out what application or library is the culprit.

Output of |strace -t -o /tmp/nautilus nautilus|:

|20:15:32 write(24, "\1\0\0\0\0\0\0\0", 8) = 8
20:15:32 poll([{fd=24, events=POLLIN}], 1, 0) = 1 ([{fd=24, revents=POLLIN}])
20:15:32 read(24, "\1\0\0\0\0\0\0\0", 16) = 8
20:15:32 write(24, "\1\0\0\0\0\0\0\0", 8) = 8
20:15:32 futex(0x56241fa9c880, FUTEX_WAKE_PRIVATE, 2147483647) = 0
20:15:32 close(24)                      = 0
20:15:32 eventfd2(0, EFD_CLOEXEC|EFD_NONBLOCK) = 24
20:15:32 write(24, "\1\0\0\0\0\0\0\0", 8) = 8
20:15:32 write(6, "\1\0\0\0\0\0\0\0", 8) = 8
20:15:32 futex(0x56241ef26dc0, FUTEX_WAKE_PRIVATE, 1) = 1
20:15:32 futex(0x56241ef26910, FUTEX_WAKE_PRIVATE, 1) = 1
20:15:32 futex(0x56241ef1c038, FUTEX_WAKE_PRIVATE, 1) = 1
20:15:32 poll([{fd=24, events=POLLIN}], 1, 25000) = 1 ([{fd=24, revents=POLLIN}])
20:15:32 read(24, "\1\0\0\0\0\0\0\0", 16) = 8
20:15:32 poll([{fd=24, events=POLLIN}], 1, 25000) = 0 (Timeout)
20:15:57 write(24, "\1\0\0\0\0\0\0\0", 8) = 8
20:15:57 futex(0x56241fa9c880, FUTEX_WAKE_PRIVATE, 2147483647) = 0
20:15:57 close(24)                      = 0
|

From the journal:

|Apr 20 20:32:35 aubrey dbus-daemon[1180]: [system] Activating via systemd: service name='org.freedesktop.hostname1' unit='dbus-org.freedesktop.hostname1.service' requested by ':1.134190' (uid=1000 pid=1450204 comm="nautilus " label="unconfined")
Apr 20 20:32:35 aubrey systemd[1]: Starting Hostname Service...
Apr 20 20:32:35 aubrey dbus-daemon[1180]: [system] Successfully activated service 'org.freedesktop.hostname1'
Apr 20 20:32:35 aubrey systemd[1]: Started Hostname Service.
Apr 20 20:32:35 aubrey nautilus[1450204]: Called "net usershare info" but it failed: Failed to execute child process “net” (No such file or directory)
Apr 20 20:32:45 aubrey ddclient[1450366]: WARNING:  file /var/cache/ddclient/ddclient.cache, line 3: Invalid Value for keyword 'ip' =
|

Edit:

The above trace is just the output of |strace -t -o /tmp/nautilus nautilus| - a very verbose log, but with |tail -f| I'm able to inspect it at the point where it hangs, which is where I
see an entry such as |20:15:32 poll([{fd=7, events=POLLIN}], 1, 25000) = 0 (Timeout)| followed by 30+ seconds of nothing (then it starts and is very verbose
again).

The fd reported by lsof, if I'm reading it right, looks like:

|nautilus 1719429 coljac    7u  a_inode               0,13        0    17491 [eventfd]|

The top entries from |strace -c nautilus| are as follows (yes, poll is number one):

|% time     seconds  usecs/call     calls    errors syscall
------ ----------- ----------- --------- --------- ----------------
 22.70    0.011333           2      3988           poll
 16.55    0.008265           1      5018      4490 stat
  9.31    0.004647           2      1966       131 futex
  7.73    0.003859           1      2119      1385 recvmsg
  7.33    0.003660           1      3612      1441 openat
  4.76    0.002375           2      1038       436 access
  4.29    0.002140           1      1424           read
  3.60    0.001799           1      1356       105 readlink
  3.50    0.001748           0      1868           mmap
  3.30    0.001646           8       188           getdents64
  3.14    0.001568           0      2232           close
  2.38    0.001188           0      1758           fstat
  2.14    0.001067           0      1150           munmap
  1.99    0.000993           2       337           writev
  1.67    0.000833          92         9           clone
  1.57    0.000782           2       367           write
  1.47    0.000733           3       190           mprotect
|

Output from |lsof | wc -l|: |1340334|

Edit 2:

Currently, thunar won't open at all - it fails with the message |Failed to register: Timeout was reached|. The output from |strace -c thunar| is as follows:

|% time     seconds  usecs/call     calls    errors syscall
------ ----------- ----------- --------- --------- ----------------
 50.53    0.002814           3       882       792 openat
 28.21    0.001571           4       354           mmap
  4.79    0.000267           2        96           read
  3.75    0.000209           2        90           fstat
  3.54    0.000197           2        96           close
  3.48    0.000194           1       109           mprotect
  1.87    0.000104           5        18           poll
  1.45    0.000081           0       165         1 futex
  1.31    0.000073           2        28           write
...
|

If I run |strace -t thunar| I also see this in the output before it hangs:

|futex(0x564445b9ff70, FUTEX_WAKE_PRIVATE, 1) = 1
poll([{fd=7, events=POLLIN}], 1, 25000) = 1 ([{fd=7, revents=POLLIN}])
read(7, "\1\0\0\0\0\0\0\0", 16)         = 8
poll([{fd=7, events=POLLIN}], 1, 25000  

|

|lsof -p <pid>| returns the following:

|thunar  2036483 coljac    7u  a_inode               0,13        0    17491 [eventfd]
|

Some more outout from |strace thunar|, which fails to open, is:

|20:29:32 read(7, "\1\0\0\0\0\0\0\0", 16) = 8
20:29:32 poll([{fd=7, events=POLLIN}], 1, 25000) = 0 (Timeout)
20:29:58 write(7, "\1\0\0\0\0\0\0\0", 8) = 8
20:29:58 futex(0x5566ad906ba0, FUTEX_WAKE_PRIVATE, 2147483647) = 0
20:29:58 close(7)                       = 0
20:29:58 write(6, "\1\0\0\0\0\0\0\0", 8) = 8
20:29:58 futex(0x5566ad8e1f70, FUTEX_WAKE_PRIVATE, 1) = 1
20:29:58 futex(0x5566ad8e1b90, FUTEX_WAKE_PRIVATE, 1) = 1
20:29:58 futex(0x5566ad8d9058, FUTEX_WAKE_PRIVATE, 1) = 1
20:29:58 openat(AT_FDCWD, "/usr/lib/x86_64-linux-gnu/charset.alias", O_RDONLY) = -1 ENOENT (No such file or directory)
20:29:58 write(2, "Failed to register: Timeout was "..., 40) = 40
20:29:58 poll([{fd=4, events=POLLIN}], 1, 0) = 1 ([{fd=4, revents=POLLIN}])
20:29:58 read(4, "\1\0\0\0\0\0\0\0", 16) = 8
20:29:58 futex(0x7f0dccfb72a0, FUTEX_WAKE_PRIVATE, 1) = 1
20:29:58 poll([{fd=4, events=POLLIN}], 1, 0) = 0 (Timeout)
|

Further strace outputs are here on pastebin <https://pastebin.com/GqiDf3tY>.

  * Also as a new user (also slow): here <https://pastebin.com/rw6Djwb8>
  * As root (not slow): here <https://pastebin.com/YwmiZLsX>

  * 20.04 <https://askubuntu.com/questions/tagged/20.04>
  * gnome <https://askubuntu.com/questions/tagged/gnome>
  * nautilus <https://askubuntu.com/questions/tagged/nautilus>
  * i3-wm <https://askubuntu.com/questions/tagged/i3-wm>

Share <https://askubuntu.com/q/1341909>
Share a link to this question
Copy link

CC BY-SA 4.0 <https://creativecommons.org/licenses/by-sa/4.0/>
Improve this question <https://askubuntu.com/posts/1341909/edit>
Follow Follow this question to receive notifications
edited Jun 7, 2021 at 11:07 <https://askubuntu.com/posts/1341909/revisions>
Coljac
asked Jun 1, 2021 at 1:12
Coljac's user avatar
 <https://askubuntu.com/users/328374/coljac>
Coljac <https://askubuntu.com/users/328374/coljac>Coljac
63222 gold badges66 silver badges2222 bronze badges
5

  *
    Could you share the |strace| output log, I could find above only strace c resume. – user.dz
    <https://askubuntu.com/users/26246/user-dz>
    Commented Jun 8, 2021 at 11:39 <#comment2296811_1341909>
  *
    4
    I think I might have the same problem. Starting my programs with |dbus-run-sessions| seems to fix it. But that does not fix the underlying cause it
    only prevents the file open dialog from speaking with the slow
    program it seems. And you will run out of D-Bus sessions after a
    month or so. I had this problem for years and your question
    motivated me to take another look at google for this and found this
    <https://forums.linuxmint.com/viewtopic.php?t=328966>. The proposed |pkill gvfsd-trash| works for me. Thank you!!! – mxmlnkn
    <https://askubuntu.com/users/437748/mxmlnkn>
    Commented Jun 27, 2021 at 7:54 <#comment2304898_1341909>
  *
    1
    And a link to the underlying bug in gvfsd:
    gitlab.gnome.org/GNOME/gvfs/-/issues/485
    <https://gitlab.gnome.org/GNOME/gvfs/-/issues/485> – mxmlnkn
    <https://askubuntu.com/users/437748/mxmlnkn>
    Commented Jun 27, 2021 at 8:05 <#comment2304902_1341909>
  *
    1
    Wow @mxmlnkn - that's a great find. The 25 second delay is precisely
    what I am seeing as well, so this seems likely the same problem.
    Once I can reproduce it again and confirm this solution I will ask
    you to expand this comment into an answer. – Coljac
    <https://askubuntu.com/users/328374/coljac>
    Commented Jun 28, 2021 at 23:22 <#comment2305562_1341909>
  *
    1
    @mxmlnkn I was just able to reproduce the issue, and |pkill gvfsd-trash| worked. If you would like to add an answer I can mark this
    question as answered. – Coljac
    <https://askubuntu.com/users/328374/coljac>
    Commented Jul 8, 2021 at 3:31 <#comment2309034_1341909>

Add a comment <#>  |  <#>


    5 Answers 5

Sorted by:

Reset to default
<https://askubuntu.com/questions/1341909/file-browser-and-file-dialogs-take-a-long-time-to-open-or-fail-to-open-in-all-ap?answertab=scoredesc#tab-top>

This answer is useful
32

Save this answer.
<https://askubuntu.com/posts/1350804/timeline>Show activity on this post.

I had the same problem for years because I have uptimes of at least a
month quite often. After a while, all programs using the system-supplied
file open dialog will seemingly hang or wait for many minutes.

You can run the following command to kill |gvfsd-trash|, after which all programs hanging and waiting for the file dialog
should immediately resume working.

|pkill gvfsd-trash
|

Another thing to note is that |gvfsd-trash| gets restarted after a while, probably by |caja| or any other file browser or by the system file open dialog itself.
This is not the first problem I had with |gvfsd-trash| and I begin to bear a grudge, however, I don't want to uninstall |gvfsd|, which I need for mounting USB thumb drives and my smartphone over
MTP. So, I opted for the brute-force solution and made only the |gvfsd-trash| binary inaccessible, e.g., by renaming it:

|sudo mv /usr/libexec/gvfsd-trash{,.bak}
|

It might be in another location on different systems, try asking your
packet manager, e.g., by calling:

|dpkg -L gvfs-daemons | grep trash
|

Beware of the implications. Without |gvfsd-trash| you won't be able to access the special |trash:///| URI path via your file browser! Personally, I never used that anyway.
You can also access deleted files manually in the |.Trash| folders, which exist for each mount point and in your home, e.g.:

  * |~/.local/share/Trash|
  * |/media/mounted-external-harddrive/.Trash|

It looks like the problem is a combination of gvfsd-trash and D-Bus.
There seems to be a fitting issue
<https://gitlab.gnome.org/GNOME/gvfs/-/issues/485> issue in the gvfs
bugtracker, which has already been fixed but has not been rolled out to
my system, yet.

For years, I used a different solution, namely starting each program in
a new DBus session by prefixing the most important programs like Firefox
and text editors with |dbus-launch|. However, that comes with its own shares of problems because each
session will spawn at least five |gvfsd| processes and possible others and the D-Bus session will not close by
closing the program opened in it and the number of D-Bus sessions in
total is limited, so after a while, you won't be able to start programs.

Share <https://askubuntu.com/a/1350804>
Share a link to this answer
Copy link

CC BY-SA 4.0 <https://creativecommons.org/licenses/by-sa/4.0/>
Improve this answer <https://askubuntu.com/posts/1350804/edit>
Follow Follow this answer to receive notifications
edited Mar 6, 2024 at 19:34 <https://askubuntu.com/posts/1350804/revisions>
Dave Yarwood's user avatar
 <https://askubuntu.com/users/725987/dave-yarwood>
Dave Yarwood <https://askubuntu.com/users/725987/dave-yarwood>
22722 silver badges99 bronze badges
answered Jul 8, 2021 at 21:02
mxmlnkn's user avatar
 <https://askubuntu.com/users/437748/mxmlnkn>
mxmlnkn <https://askubuntu.com/users/437748/mxmlnkn>mxmlnkn
1,45011 gold badge1212 silver badges99 bronze badges
12

  *
    3
    This fixed the problem for me - it was very difficult to find this
    out, thanks for the answer. – Coljac
    <https://askubuntu.com/users/328374/coljac>
    Commented Jul 10, 2021 at 3:27 <#comment2309690_1350804>
  *
    2
    Same here, spent ages trying to figure out Nautilus being slow to
    open and this resolved it. – Mikesname
    <https://askubuntu.com/users/13747/mikesname>
    Commented Jul 13, 2021 at 14:51 <#comment2311047_1350804>
  *
    1
    @xgdgsc I fixed the link. For some reason, Github didn't like the
    standard markdown syntax as it looks good to me. Weird. – mxmlnkn
    <https://askubuntu.com/users/437748/mxmlnkn>
    Commented Aug 16, 2021 at 11:53 <#comment2326174_1350804>
  *
    2
    @sdlins :) Thanks. Those are bash brace expansions
    <https://www.gnu.org/software/bash/manual/html_node/Brace-Expansion.html>. They frequently save me typing work in the shell. – mxmlnkn <https://askubuntu.com/users/437748/mxmlnkn>
    Commented Dec 19, 2021 at 15:14 <#comment2384246_1350804>
  *
    1
    @dan-gph It took me a while but after googling every month or so for
    a while, I found an answer in the Linux Mint forum
    <https://forums.linuxmint.com/viewtopic.php?t=328966>, see also my
    comment under the question. – mxmlnkn
    <https://askubuntu.com/users/437748/mxmlnkn>
    Commented Dec 7, 2022 at 15:26 <#comment2520760_1350804>

<#>  |  Show *7* more comments <#>

This answer is useful
3

Save this answer.
+150
This answer has been awarded bounties worth 150 reputation by Coljac
<https://askubuntu.com/posts/1342385/timeline>Show activity on this post.


    Diagnosis

I guess you are showing an excerpt from you strace log, pointing to
where the lag occurs. It would be useful if you posted the full |strace| command you used.

Actions that may lead to the culprit:

 1.

    While an |strace|d |nautilus| is running, in another terminal use

    |$ pidof nautilus
    $ lsof -p <pidno>
    |

    where |<pidno>| is the PID returned by the previous command. That lets you inspect
    which file descriptors (answer to your question: /Yes/) the strace
    log refers to (source
    <https://stackoverflow.com/questions/13018981/poll-system-call-timeout>). You might want to pipe the output with |less| since it is typically long.

 2.

    Option |-c| can further help identifying bottleneck processes (source
    <https://serverfault.com/questions/223777/strace-poll-trying-to-diagnose-bottleneck>), yours is probably |poll|. From the |man strace| page:

    |-c
    --summary-only
                Count time, calls, and errors for each system call and report a summary on program exit, suppressing the  regular
                output.  This attempts to show system time (CPU time spent running in the kernel) independent of wall clock time.
                If -c is used with -f, only aggregate totals for all traced processes are kept.
    |

    This is an example of what the output looks like

    |% time     seconds  usecs/call     calls    errors syscall
    ------ ----------- ----------- --------- --------- ----------------
     18,29    0,009128           4      2058           mmap
     15,19    0,007580           7       989         1 poll
     11,96    0,005967           2      2465       318 openat
      6,76    0,003374           1      2187           close
    ...
    |

 3.

    Check other instances of delayed nautilus and thunar launching, to
    confirm a similar pattern.

 4.

    Apply the above, and any further diagnostic commands, to a
    comparison with what a root instance (which you mention it /works
    fine.../, I guess you meant /... at times where with a normal user
    the delays already appeared/) produces.

 5.

    Consider the problem /might/ be related to availability of file
    descriptors, or the like, see this
    <https://serverfault.com/a/223779/326962>.

 6.

    Please post the complete output of

    |$ bash -c 'time strace -fc nautilus'
    $ bash -c 'time strace -fc thunar'
    $ bash -c 'strace -fc time nautilus'
    $ bash -c 'strace -fc time thunar'
    |

 7.

    Please mention whether you moved your home dir, if you had a
    different Ubuntu version and updated, etc., as it may be relevant
    <https://askubuntu.com/questions/1234298/nautilus-does-not-start-cache-tracker-meta-db-not-found>. Also, try creating a temporary user to see if the problem shows up. This would be an additional proof to comparing with root.

    *EDIT a*: The comparison between what you get with users |<you>|, |tester| and |root|, for |bash -c 'time strace -fc nautilus'|, shows the following essential difference in terms of what could
    be spending the ~30sec at launching:

    |<you>|:

    |(org.gnome.Nautilus:2641915): Tracker-WARNING **: 18:30:21.999: Falling back 
    to bus backend, the direct backend failed to initialize: Could not find datab
    ase file:'/home/coljac/.cache/tracker/meta.db'.
    |

    |tester|:

    |(org.gnome.Nautilus:2976790): dbind-WARNING **: 20:45:38.814: Couldn't register with accessibility bus: Did not receive a reply. Possible causes include: the remote application did not send a reply, the message bus security policy blocked the reply, the reply timeout expired, or the network connection was broken.
    strace: Process 2976919 attached
    strace: Process 2976920 attached

    ** (org.gnome.Nautilus:2976790): WARNING **: 20:46:04.102: Unable to get contents of the bookmarks file: Error opening file /home/tester/.gtk-bookmarks: No such file or directory
    |

    |root|:

    |** (org.gnome.Nautilus:2980894): WARNING **: 21:00:42.191: Unable to get contents of the bookmarks file: Error opening file /root/.gtk-bookmarks: No such file or directory

    ** (org.gnome.Nautilus:2980894): WARNING **: 21:00:42.191: Unable to get contents of the bookmarks file: Error opening file /root/.gtk-bookmarks: No such file or directory
    strace: Process 2980907 attached
    Nautilus-Share-Message: 21:00:42.241: Called "net usershare info" but it failed: Failed to execute child process “net” (No such file or directory)
    |

    So, |tester| vs. |root| shows a warning that could help with diagnosis. The strange thing
    is that the same warning does not show for |<you>|.


    Solution

I would wait until you post more info after the diagnosis suggested. In
the meantime, I give a (nuke?) workaround. I am assuming your "several
machines with very similar setups" are a sort of clones (at least in the
beginning) of each other. If so, and you don't find a /solution/ (after
the /diagnosis/), and this bothers you enough, you might try cloning
again from one of your working systems, with |clonezilla|, e.g.


    Related

 1. https://www.linuxquestions.org/questions/linux-server-73/strace-question-poll-taking-a-long-time-on-an-open-command-939714/ <https://www.linuxquestions.org/questions/linux-server-73/strace-question-poll-taking-a-long-time-on-an-open-command-939714/>
 2. Nautilus does not start: .cache/tracker/meta.db not found
    <https://askubuntu.com/questions/1234298/nautilus-does-not-start-cache-tracker-meta-db-not-found>

Share <https://askubuntu.com/a/1342385>
Share a link to this answer
Copy link

CC BY-SA 4.0 <https://creativecommons.org/licenses/by-sa/4.0/>
Improve this answer <https://askubuntu.com/posts/1342385/edit>
Follow Follow this answer to receive notifications
edited Jun 15, 2021 at 10:30
<https://askubuntu.com/posts/1342385/revisions>
answered Jun 3, 2021 at 8:44
sancho.s ReinstateMonicaCellio's user avatar
 <https://askubuntu.com/users/226614/sancho-s-reinstatemonicacellio>
sancho.s ReinstateMonicaCellio
<https://askubuntu.com/users/226614/sancho-s-reinstatemonicacellio>sancho.s ReinstateMonicaCellio
15.1k1212 gold badges4949 silver badges108108 bronze badges
15

  *
    Thanks for the helpful answer. I've updated the question with some
    more information, following your suggestions. Regarding the nuclear
    option, I have indeed tried just reinstalling the OS from scratch,
    and eventually the problem came back; I can only assume it's some
    piece of software that I need to or habitually use is causing the
    problem. – Coljac <https://askubuntu.com/users/328374/coljac>
    Commented Jun 3, 2021 at 12:27 <#comment2293604_1342385>
  *
    @Coljac - Based on your feedback, I have a few comments (which I may
    transfer later to the answer to make everything clearer). 1) with your |strace -c|, poll is number one, but still with a fraction of a second. It
    seems all the delay is not counted in |strace -c|, I am not familiar with such a case. 2) I am surprised
    reinstalling OS the problem comes back. Do you have at least one of
    the "similar systems" exactly the same as the failing one, in terms
    of hardware? Or can you put together a system like that? If so, I
    would exchange hard disks, just to discard a hardware failure
    (unlikely). – sancho.s ReinstateMonicaCellio
    <https://askubuntu.com/users/226614/sancho-s-reinstatemonicacellio>
    Commented Jun 3, 2021 at 13:01 <#comment2293618_1342385>
  *
    Seems this is a tricky one. I added the outout of |strace -c thunar| to the question; thunar won't even open at the moment, it just
    times out. There are a lot of openat syscalls with errors. I don't
    know what this means, is it significant? strace for thunar and other
    apps that hang show the same fd information as for nautilus, i.e. |[eventfd]|. – Coljac <https://askubuntu.com/users/328374/coljac>
    Commented Jun 3, 2021 at 23:18 <#comment2293894_1342385>
  *
    1
    I put the resulting outputs here on pastebin; I'll edit them into
    the (already long) question if it proves fruitful.
    pastebin.com/GqiDf3tY <https://pastebin.com/GqiDf3tY> – Coljac
    <https://askubuntu.com/users/328374/coljac>
    Commented Jun 6, 2021 at 9:00 <#comment2295895_1342385>
  *
    1
    With your added info, please. 1) See the two *EDIT* points. 2) Apply
    the commands also for |root| level and/or a new temporary |user|, and compare the outputs. Do so for all diagnostic commands and
    post the output from now on. Those extra couple of minutes could be
    essential to solve the problem. – sancho.s ReinstateMonicaCellio
    <https://askubuntu.com/users/226614/sancho-s-reinstatemonicacellio>
    Commented Jun 7, 2021 at 8:14 <#comment2296318_1342385>

<#>  |  Show *10* more comments <#>

This answer is useful
3

Save this answer.
<https://askubuntu.com/posts/1399526/timeline>Show activity on this post.

Thanks for the answers and clues here.

I believe I solved this by just changing

|AutoMount=true| to |AutoMount=false| in |/usr/share/gvfs/mounts/trash.mount|

I logged out and logged in and it was still ok. Had also uninstalled
following packages

|xdg-desktop-portal 
xdg-desktop-portal-gtk
|

as suggested in this Reddit post
<https://www.reddit.com/r/archlinux/comments/q619w0/dbus_and_slow_initial_launch_of_some_apps/>.

Share <https://askubuntu.com/a/1399526>
Share a link to this answer
Copy link

CC BY-SA 4.0 <https://creativecommons.org/licenses/by-sa/4.0/>
Improve this answer <https://askubuntu.com/posts/1399526/edit>
Follow Follow this answer to receive notifications
edited Apr 6, 2022 at 8:49 <https://askubuntu.com/posts/1399526/revisions>
Zanna's user avatar
 <https://askubuntu.com/users/527764/zanna>
Zanna <https://askubuntu.com/users/527764/zanna>♦
71.9k6060 gold badges223223 silver badges330330 bronze badges
answered Mar 27, 2022 at 14:23
Krish's user avatar
 <https://askubuntu.com/users/1582274/krish>
Krish <https://askubuntu.com/users/1582274/krish>Krish
3111 bronze badge
2

  *
    1
    You're crazy - removing xdg-desktop-portal and
    xdg-desktop-portal-gtk also removes:
    gnome-shell-extension-desktop-icons-ng nautilus shotwell
    ubuntu-desktop ubuntu-desktop-minimal ubuntu-session
    xdg-desktop-portal xdg-desktop-portal-gnome xdg-desktop-portal-gtk
    – Aries <https://askubuntu.com/users/44627/aries>
    Commented Dec 10, 2023 at 18:26 <#comment2620430_1399526>
  *
    just the |AutoMount=false| did it for me. – Remco <https://askubuntu.com/users/1564882/remco>
    Commented Apr 5, 2024 at 15:46 <#comment2648981_1399526>

Add a comment <#>  |  <#>

This answer is useful
1

Save this answer.
<https://askubuntu.com/posts/1341910/timeline>Show activity on this post.

There are a couple of items that might cause Nautilus to slow down. I've
seen this happen on notebooks that are used primarily for artwork and
contained — quite literally — millions of thumbnail files sitting in |~/.cache/thumbnails|. Scrubbing the directory had an immediate impact on the speed of
launching Nautilus (not to mention freeing up quite a bit of storage space).

Another item to look at would be anything in |~/.local/share/nautilus| that might be causing an issue, such as looking up a network share
that is no longer available.

As a last-ditch effort, if you have a |~/.cache/dconf/user| file, you can see if there's a configuration problem in the |dconf| settings for your user account. The simplest way to test this would be
to rename |~/.cache/dconf/user| to something like |~/.cache/dconf/user-old| and then restart the shell by pressing Alt+F2 to bring up a command
input, type |r|, then hit Enter. If the problem persists, you can return the renamed
file to its proper place.

Hopefully something here will help you out.

Share <https://askubuntu.com/a/1341910>
Share a link to this answer
Copy link

CC BY-SA 4.0 <https://creativecommons.org/licenses/by-sa/4.0/>
Improve this answer <https://askubuntu.com/posts/1341910/edit>
Follow Follow this answer to receive notifications
answered Jun 1, 2021 at 1:31
matigo's user avatar
 <https://askubuntu.com/users/1222991/matigo>
matigo <https://askubuntu.com/users/1222991/matigo>matigo
24.3k77 gold badges4848 silver badges7878 bronze badges
3

  *
    Thanks for the suggestions. This isn't an issue that's specific to
    nautilus (any file dialog hangs for a while or forever), but I tried
    the first suggestions without success. Regarding dconf, I will try
    this and reboot and report back. Are there any particular settings
    that might be responsible? I also note that nautilus is slow to
    launch, but responsive when it has done so. – Coljac
    <https://askubuntu.com/users/328374/coljac>
    Commented Jun 1, 2021 at 6:18 <#comment2292609_1341910>
  *
    Are you mounting any network share with the user where file dialog
    is slow?. This is typical with network timeouts in iSCSI or NFS
    mounts points. – Carles Mateo
    <https://askubuntu.com/users/983957/carles-mateo>
    Commented Jun 3, 2021 at 7:34 <#comment2293495_1341910>
  *
    No network share mounted. – Coljac
    <https://askubuntu.com/users/328374/coljac>
    Commented Jun 4, 2021 at 0:11 <#comment2293920_1341910>

Add a comment <#>  |  <#>

This answer is useful
1

Save this answer.
<https://askubuntu.com/posts/1365132/timeline>Show activity on this post.

Following mxmlnkn excellent answer, I've implemented a simple oneshot
systemd service that kills gvfdsd-trash and prevents it from ever
running again. This is useful when an unattended upgrade reinstall
/usr/libexec/gvfsd-trash..

/usr/local/bin/clean-gvfsd-trash :

|$ sudo tee /usr/local/bin/clean-gvfsd-trash << EOF > /dev/null
#!/bin/bash
pkill gvfsd-trash
path=$(dpkg -L gvfs-daemons | grep gvfsd-trash|xargs realpath|uniq)
mv $path{,.bak} || true
EOF

$ sudo chmod u+x /usr/local/bin/clean-gvfsd-trash
|

/lib/systemd/system/clean-gvfsd-trash.service :

|$ sudo tee /lib/systemd/system/clean-gvfsd-trash.service << EOF > /dev/null
[Unit]
Description=kill gvfsd-trash and prevent it from ever running again
Documentation=https://askubuntu.com/questions/1341909/file-browser-and-file-dialogs-take-a-long-time-to-open-or-fail-to-open-in-all-ap

[Service]
ExecStart=/usr/local/bin/clean-gvfsd-trash
Type=oneshot
RemainAfterExit=no

[Install]
WantedBy=multi-user.target
EOF
|

Service activation:

|$ sudo systemctl daemon-reload
$ sudo systemctl enable clean-gvfsd-trash.service
$ sudo systemctl start clean-gvfsd-trash.service
|

Share <https://askubuntu.com/a/1365132>
Share a link to this answer
Copy link

CC BY-SA 4.0 <https://creativecommons.org/licenses/by-sa/4.0/>
Improve this answer <https://askubuntu.com/posts/1365132/edit>
Follow Follow this answer to receive notifications
edited Feb 18, 2022 at 10:21
<https://askubuntu.com/posts/1365132/revisions>
answered Sep 22, 2021 at 11:02
Nicolas's user avatar
 <https://askubuntu.com/users/538604/nicolas>
Nicolas <https://askubuntu.com/users/538604/nicolas>Nicolas
11133 bronze badges
1

  *
    Add |sudo chmod u+x /usr/local/bin/clean-gvfsd-trash| to grant exec permission – j3ffyang
    <https://askubuntu.com/users/53270/j3ffyang>
    Commented Jan 20, 2022 at 8:45 <#comment2397375_1365132>

Add a comment <#>  |  <#>


    You must log in
    <https://askubuntu.com/users/login?ssrc=question_page&returnurl=https%3a%2f%2faskubuntu.com%2fquestions%2f1341909> to answer this question.


    Not the answer you're looking for? Browse other questions tagged

      * 20.04 <https://askubuntu.com/questions/tagged/20.04>
      * gnome <https://askubuntu.com/questions/tagged/gnome>
      * nautilus <https://askubuntu.com/questions/tagged/nautilus>
      * i3-wm <https://askubuntu.com/questions/tagged/i3-wm>

    .

  * The Overflow Blog
  *
    Our next phase—Q&A was just the beginning
    <https://stackoverflow.blog/2025/02/27/our-next-phase-q-and-a-was-just-the-beginning/?cb=1>
  *
    “Translation is the tip of the iceberg”: A deep dive into specialty
    models
    <https://stackoverflow.blog/2025/02/28/translation-is-the-tip-of-the-iceberg-a-deep-dive-into-specialty-models/?cb=1>
  * Featured on Meta
  *
    bigbird and Frog have joined us as Community Managers
    <https://meta.stackexchange.com/questions/406575/bigbird-and-frog-have-joined-us-as-community-managers?cb=1>
  *
    Recapping Stack’s first community-wide AMA (Ask Me Anything)
    <https://meta.stackexchange.com/questions/407025/recapping-stack-s-first-community-wide-ama-ask-me-anything?cb=1>
  *
    My answer has been edited 11 times by one user over five years to
    the point...
    <https://meta.askubuntu.com/questions/20648/my-answer-has-been-edited-11-times-by-one-user-over-five-years-to-the-point-of-u?cb=1>


        Linked

6
<https://askubuntu.com/q/1254787?lq=1> Pop up dialogs very slow on
Ubuntu 20.04
<https://askubuntu.com/questions/1254787/pop-up-dialogs-very-slow-on-ubuntu-20-04?noredirect=1&lq=1>
4
<https://askubuntu.com/q/1378721?lq=1> Why does Dolphin take forever to
load on Kubuntu 20.04 all of a sudden?
<https://askubuntu.com/questions/1378721/why-does-dolphin-take-forever-to-load-on-kubuntu-20-04-all-of-a-sudden?noredirect=1&lq=1>
1
<https://askubuntu.com/q/1234298?lq=1> Nautilus does not start:
.cache/tracker/meta.db not found
<https://askubuntu.com/questions/1234298/nautilus-does-not-start-cache-tracker-meta-db-not-found?noredirect=1&lq=1>


        Related

6
<https://askubuntu.com/q/76054?rq=1> How to Open terminal and Embed
Terminal To Nautilus File Browser?
<https://askubuntu.com/questions/76054/how-to-open-terminal-and-embed-terminal-to-nautilus-file-browser?rq=1>
1
<https://askubuntu.com/q/1060554?rq=1> Set priorities for file-open
applications
<https://askubuntu.com/questions/1060554/set-priorities-for-file-open-applications?rq=1>
0
<https://askubuntu.com/q/1230999?rq=1> long time to open Ubuntu 20.04
Software Center
<https://askubuntu.com/questions/1230999/long-time-to-open-ubuntu-20-04-software-center?rq=1>
0
<https://askubuntu.com/q/1237747?rq=1> Ubuntu 20.04 - Applications take
too long to start up
<https://askubuntu.com/questions/1237747/ubuntu-20-04-applications-take-too-long-to-start-up?rq=1>
3
<https://askubuntu.com/q/1247877?rq=1> Nautilus doesn't open initially
but after a long time it starts working fine
<https://askubuntu.com/questions/1247877/nautilus-doesnt-open-initially-but-after-a-long-time-it-starts-working-fine?rq=1>
2
<https://askubuntu.com/q/1298514?rq=1> All files open in browser
<https://askubuntu.com/questions/1298514/all-files-open-in-browser?rq=1>
0
<https://askubuntu.com/q/1440534?rq=1> Activities Overview showing all
open applications?
<https://askubuntu.com/questions/1440534/activities-overview-showing-all-open-applications?rq=1>


        Hot Network Questions <https://stackexchange.com/questions?tab=hot>

  *
    Why Did St. Irenaeus say the Church was Founded and Organized in
    Rome by Peter and Paul?
    <https://christianity.stackexchange.com/questions/105329/why-did-st-irenaeus-say-the-church-was-founded-and-organized-in-rome-by-peter-a>
  *
    Is it possible to "downgrade" to GPL 3.0 after having applied AGPL
    3.0 already?
    <https://opensource.stackexchange.com/questions/15389/is-it-possible-to-downgrade-to-gpl-3-0-after-having-applied-agpl-3-0-already>
  *
    Does current really require a closed path to flow?
    <https://electronics.stackexchange.com/questions/740158/does-current-really-require-a-closed-path-to-flow>
  *
    Unwrapping a self made cube
    <https://blender.stackexchange.com/questions/331772/unwrapping-a-self-made-cube>
  *
    Is there an official site for Sage Advice and Errata for 5e 2024/25?
    <https://rpg.stackexchange.com/questions/214876/is-there-an-official-site-for-sage-advice-and-errata-for-5e-2024-25>
  *
    Determine the chess knight’s tour of a 6x6 chessboard given some
    hints
    <https://puzzling.stackexchange.com/questions/130796/determine-the-chess-knight-s-tour-of-a-6x6-chessboard-given-some-hints>
  *
    How to change 2 variables in a loop and keep the first one?
    <https://tex.stackexchange.com/questions/738057/how-to-change-2-variables-in-a-loop-and-keep-the-first-one>
  *
    How many Nightriders can be safely placed on a chess board?
    <https://puzzling.stackexchange.com/questions/130763/how-many-nightriders-can-be-safely-placed-on-a-chess-board>
  *
    How to get historical Schengen travel records
    <https://travel.stackexchange.com/questions/193559/how-to-get-historical-schengen-travel-records>
  *
    Who discovered that vacuum tubes could be used for logic and
    computation?
    <https://hsm.stackexchange.com/questions/18352/who-discovered-that-vacuum-tubes-could-be-used-for-logic-and-computation>
  *
    Why are browser HTTP auth schemes stuck in 1999?
    <https://security.stackexchange.com/questions/280681/why-are-browser-http-auth-schemes-stuck-in-1999>
  *
    Does human skin recover better in dry or humid environments?
    <https://medicalsciences.stackexchange.com/questions/34490/does-human-skin-recover-better-in-dry-or-humid-environments>
  *
    Shimano hub dynamo dead after not turning due to cold
    <https://bicycles.stackexchange.com/questions/96281/shimano-hub-dynamo-dead-after-not-turning-due-to-cold>
  *
    Did the Trump administration explain why the US-Ukraine minerals
    deal does not include security guarantees?
    <https://politics.stackexchange.com/questions/90773/did-the-trump-administration-explain-why-the-us-ukraine-minerals-deal-does-not-i>
  *
    How can implicit Euler numerical method solve these ODEs?
    <https://scicomp.stackexchange.com/questions/44920/how-can-implicit-euler-numerical-method-solve-these-odes>
  *
    What is the word for someone who follows instructions incorrectly
    but believes what they're doing is right?
    <https://english.stackexchange.com/questions/629630/what-is-the-word-for-someone-who-follows-instructions-incorrectly-but-believes-w>
  *
    Is Google's Generative AI accurate for the query "monte carlo power
    analysis sample size"?
    <https://stats.stackexchange.com/questions/661963/is-googles-generative-ai-accurate-for-the-query-monte-carlo-power-analysis-sam>
  *
    Catching download filename of wget or cURL command?
    <https://superuser.com/questions/1883717/catching-download-filename-of-wget-or-curl-command>
  *
    Origin of "foo", "bar", and "baz"
    <https://retrocomputing.stackexchange.com/questions/31354/origin-of-foo-bar-and-baz>
  *
    How could I justify a fast apocalypse?
    <https://worldbuilding.stackexchange.com/questions/264945/how-could-i-justify-a-fast-apocalypse>
  *
    PTIJ: Prohibition of Centaur Meat
    <https://judaism.stackexchange.com/questions/147897/ptij-prohibition-of-centaur-meat>
  *
    Can radar indicators be manipulated?
    <https://aviation.stackexchange.com/questions/108098/can-radar-indicators-be-manipulated>
  *
    How can I count the number of unique data types in Geometry Nodes?
    <https://blender.stackexchange.com/questions/331761/how-can-i-count-the-number-of-unique-data-types-in-geometry-nodes>
  *
    Predicting the number of disabled people in Canada
    <https://stats.stackexchange.com/questions/661982/predicting-the-number-of-disabled-people-in-canada>

Question feed <https://askubuntu.com/feeds/question/1341909>


  Subscribe to RSS

Question feed

To subscribe to this RSS feed, copy and paste this URL into your RSS reader.

<#>


          Ask Ubuntu <https://askubuntu.com/>

  * Tour <https://askubuntu.com/tour>
  * Help <https://askubuntu.com/help>
  * Chat <https://chat.stackexchange.com/?tab=site&host=askubuntu.com>
  * Contact <https://askubuntu.com/contact>
  * Feedback <https://meta.askubuntu.com/>


          Company <https://stackoverflow.co/>

  * Stack Overflow <https://stackoverflow.com/>
  * Teams <https://stackoverflow.co/teams/>
  * Advertising <https://stackoverflow.co/advertising/>
  * Talent <https://stackoverflow.co/advertising/employer-branding/>
  * About <https://stackoverflow.co/>
  * Press <https://stackoverflow.co/company/press/>
  * Legal <https://stackoverflow.com/legal>
  * Privacy Policy <https://stackoverflow.com/legal/privacy-policy>
  * Terms of Service
    <https://stackoverflow.com/legal/terms-of-service/public>
  * Cookie Settings
  * Cookie Policy <https://stackoverflow.com/legal/cookie-policy>


          Stack Exchange Network <https://stackexchange.com/>

  * Technology <https://stackexchange.com/sites#technology>
  * Culture & recreation
    <https://stackexchange.com/sites#culturerecreation>
  * Life & arts <https://stackexchange.com/sites#lifearts>
  * Science <https://stackexchange.com/sites#science>
  * Professional <https://stackexchange.com/sites#professional>
  * Business <https://stackexchange.com/sites#business>
  * API <https://api.stackexchange.com/>
  * Data <https://data.stackexchange.com/>

  * Blog <https://stackoverflow.blog/?blb=1>
  * Facebook <https://www.facebook.com/officialstackoverflow/>
  * Twitter <https://twitter.com/stackoverflow>
  * LinkedIn <https://linkedin.com/company/stack-overflow>
  * Instagram <https://www.instagram.com/thestackoverflow>

Site design / logo © 2025 Stack Exchange Inc; user contributions
licensed under CC BY-SA <https://stackoverflow.com/help/licensing> .
rev 2025.2.28.23286

Ubuntu and the circle of friends logo are trade marks of Canonical
Limited and are used under licence.

visual
